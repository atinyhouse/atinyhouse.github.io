<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å³åˆ»åŠ¨æ€ä¸€é”®è·å–å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            line-height: 1.8;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 40px;
        }
        .bookmarklet {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
        }
        .bookmarklet:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        .step {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
            border-radius: 4px;
        }
        .step h3 {
            margin-top: 0;
            color: #3498db;
        }
        code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 2px 8px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', monospace;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        textarea {
            width: 100%;
            min-height: 200px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 4px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>ğŸ“± å³åˆ»åŠ¨æ€ä¸€é”®è·å–å·¥å…·</h1>

    <p>ä½¿ç”¨æ­¤å·¥å…·å¯ä»¥å¿«é€Ÿå°†å³åˆ»åŠ¨æ€å¯¼å‡ºä¸º YAML æ ¼å¼ï¼Œé€‚ç”¨äºåšå®¢ Thoughts é¡µé¢ã€‚</p>

    <h2>ğŸš€ æ–¹æ³•ä¸€ï¼šæµè§ˆå™¨ä¹¦ç­¾æŒ‰é’®ï¼ˆæœ€ç®€å•ï¼‰</h2>

    <div class="step">
        <h3>æ­¥éª¤ 1: æ‹–æ‹½æ­¤æŒ‰é’®åˆ°ä¹¦ç­¾æ </h3>
        <p>
            <a href="javascript:(function(){const posts=[];let postElements=document.querySelectorAll('[class*=&quot;Feed&quot;] > div, [class*=&quot;feed&quot;] > div, article');if(postElements.length===0){alert('æœªæ‰¾åˆ°åŠ¨æ€å†…å®¹ï¼Œè¯·ç¡®ä¿é¡µé¢å·²åŠ è½½å®Œæˆ');return}postElements.forEach((el,idx)=>{if(idx>20)return;const post={};const dateEl=el.querySelector('time, [class*=&quot;time&quot;], [class*=&quot;date&quot;]');if(dateEl){const dateStr=dateEl.getAttribute('datetime')||dateEl.textContent;try{const date=new Date(dateStr);post.date=date.toISOString().split('T')[0];post.time=date.toTimeString().substring(0,5)}catch(e){}}const contentEl=el.querySelector('[class*=&quot;content&quot;], [class*=&quot;text&quot;], p');if(contentEl){let text=contentEl.textContent.trim();text=text.replace(/\s+/g,' ').substring(0,500);if(text)post.content=text}const imgs=el.querySelectorAll('img[src*=&quot;cdnv2.ruguoapp&quot;], img[src*=&quot;jike&quot;], img[alt]');if(imgs.length>0){post.images=Array.from(imgs).slice(0,4).map(img=>img.src).filter(src=>!src.includes('avatar'))}const links=el.querySelectorAll('a[href^=&quot;http&quot;]');if(links.length>0){links.forEach(link=>{const href=link.href;if(!href.includes('okjike.com')&&!href.includes('ruguoapp.com')){post.link=href;post.link_title=link.textContent.trim()||'æŸ¥çœ‹é“¾æ¥'}})}if(post.content||post.images){posts.push(post)}});if(posts.length===0){alert('æœªæ‰¾åˆ°æœ‰æ•ˆåŠ¨æ€');return}let yaml='# å³åˆ»åŠ¨æ€æ•°æ®\n# ç”Ÿæˆæ—¶é—´: '+new Date().toLocaleString()+'\n\n';posts.forEach(post=>{yaml+='- date: '+post.date+'\n';if(post.time)yaml+='  time: &quot;'+post.time+'&quot;\n';if(post.content){const lines=post.content.split('\n');if(lines.length>1){yaml+='  content: |\n';lines.forEach(line=>yaml+='    '+line+'\n')}else{yaml+='  content: '+post.content+'\n'}}if(post.images){yaml+='  images:\n';post.images.forEach(img=>yaml+='    - '+img+'\n')}if(post.link){yaml+='  link: '+post.link+'\n';yaml+='  link_title: '+post.link_title+'\n'}yaml+='\n'});const blob=new Blob([yaml],{type:'text/yaml'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='thoughts.yml';a.click();alert('æˆåŠŸæå– '+posts.length+' æ¡åŠ¨æ€ï¼\næ–‡ä»¶å·²ä¸‹è½½ä¸º thoughts.yml')})();" class="bookmarklet">
                ğŸš€ æŠ“å–å³åˆ»åŠ¨æ€
            </a>
        </p>
        <p style="color: #666; font-size: 14px;">
            ğŸ’¡ æç¤ºï¼šå°†ä¸Šé¢çš„æŒ‰é’®æ‹–æ‹½åˆ°æµè§ˆå™¨çš„ä¹¦ç­¾æ 
        </p>
    </div>

    <div class="step">
        <h3>æ­¥éª¤ 2: è®¿é—®å³åˆ»ä¸»é¡µ</h3>
        <p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä½ çš„å³åˆ»ä¸»é¡µï¼š</p>
        <p><a href="https://web.okjike.com/u/71A6B3C3-1382-4121-A17A-2A4C05CB55E8" target="_blank">https://web.okjike.com/u/71A6B3C3-1382-4121-A17A-2A4C05CB55E8</a></p>
    </div>

    <div class="step">
        <h3>æ­¥éª¤ 3: ç­‰å¾…é¡µé¢åŠ è½½</h3>
        <p>ç¡®ä¿åŠ¨æ€å†…å®¹å·²ç»å…¨éƒ¨åŠ è½½å®Œæˆï¼ˆå¯ä»¥å‘ä¸‹æ»šåŠ¨åŠ è½½æ›´å¤šï¼‰</p>
    </div>

    <div class="step">
        <h3>æ­¥éª¤ 4: ç‚¹å‡»ä¹¦ç­¾æŒ‰é’®</h3>
        <p>ç‚¹å‡»åˆšæ‰æ·»åŠ çš„"æŠ“å–å³åˆ»åŠ¨æ€"ä¹¦ç­¾æŒ‰é’®ï¼Œè‡ªåŠ¨ä¸‹è½½ <code>thoughts.yml</code> æ–‡ä»¶</p>
    </div>

    <div class="step">
        <h3>æ­¥éª¤ 5: æ›¿æ¢æ–‡ä»¶</h3>
        <p>å°†ä¸‹è½½çš„ <code>thoughts.yml</code> æ–‡ä»¶æ›¿æ¢åˆ°ï¼š</p>
        <code>/Users/didi/Desktop/b/atinyhouse.github.io/_data/thoughts.yml</code>
    </div>

    <div class="success">
        âœ… å®Œæˆï¼è¿è¡Œ <code>bundle exec jekyll serve</code> æŸ¥çœ‹æ•ˆæœ
    </div>

    <hr style="margin: 60px 0; border: none; border-top: 2px dashed #ddd;">

    <h2>ğŸ› ï¸ æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å¤åˆ¶ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰</h2>

    <div class="step">
        <h3>å¦‚æœä¹¦ç­¾æ–¹æ³•ä¸workï¼Œä½¿ç”¨æ­¤æ–¹æ³•ï¼š</h3>
        <ol>
            <li>è®¿é—®å³åˆ»ä¸»é¡µå¹¶ç™»å½•</li>
            <li>æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·</li>
            <li>åˆ‡æ¢åˆ° Consoleï¼ˆæ§åˆ¶å°ï¼‰æ ‡ç­¾</li>
            <li>å¤åˆ¶ä¸‹é¢çš„ä»£ç ç²˜è´´åˆ°æ§åˆ¶å°å¹¶å›è½¦</li>
        </ol>

        <textarea id="consoleCode" readonly>
// å³åˆ»åŠ¨æ€æå–ä»£ç 
const posts = [];
let postElements = document.querySelectorAll('[class*="Feed"] > div, [class*="feed"] > div, article');

if (postElements.length === 0) {
    alert('æœªæ‰¾åˆ°åŠ¨æ€å†…å®¹ï¼Œè¯·ç¡®ä¿é¡µé¢å·²åŠ è½½å®Œæˆ');
} else {
    postElements.forEach((el, idx) => {
        if (idx > 20) return; // åªæå–å‰20æ¡

        const post = {};

        // æå–æ—¥æœŸ
        const dateEl = el.querySelector('time, [class*="time"], [class*="date"]');
        if (dateEl) {
            const dateStr = dateEl.getAttribute('datetime') || dateEl.textContent;
            try {
                const date = new Date(dateStr);
                post.date = date.toISOString().split('T')[0];
                post.time = date.toTimeString().substring(0, 5);
            } catch(e) {}
        }

        // æå–å†…å®¹
        const contentEl = el.querySelector('[class*="content"], [class*="text"], p');
        if (contentEl) {
            let text = contentEl.textContent.trim();
            text = text.replace(/\s+/g, ' ').substring(0, 500);
            if (text) post.content = text;
        }

        // æå–å›¾ç‰‡
        const imgs = el.querySelectorAll('img[src*="cdnv2.ruguoapp"], img[src*="jike"], img[alt]');
        if (imgs.length > 0) {
            post.images = Array.from(imgs)
                .slice(0, 4)
                .map(img => img.src)
                .filter(src => !src.includes('avatar'));
        }

        // æå–é“¾æ¥
        const links = el.querySelectorAll('a[href^="http"]');
        if (links.length > 0) {
            links.forEach(link => {
                const href = link.href;
                if (!href.includes('okjike.com') && !href.includes('ruguoapp.com')) {
                    post.link = href;
                    post.link_title = link.textContent.trim() || 'æŸ¥çœ‹é“¾æ¥';
                }
            });
        }

        if (post.content || post.images) {
            posts.push(post);
        }
    });

    // ç”Ÿæˆ YAML
    let yaml = '# å³åˆ»åŠ¨æ€æ•°æ®\n# ç”Ÿæˆæ—¶é—´: ' + new Date().toLocaleString() + '\n\n';

    posts.forEach(post => {
        yaml += '- date: ' + post.date + '\n';
        if (post.time) yaml += '  time: "' + post.time + '"\n';
        if (post.content) {
            const lines = post.content.split('\n');
            if (lines.length > 1) {
                yaml += '  content: |\n';
                lines.forEach(line => yaml += '    ' + line + '\n');
            } else {
                yaml += '  content: ' + post.content + '\n';
            }
        }
        if (post.images) {
            yaml += '  images:\n';
            post.images.forEach(img => yaml += '    - ' + img + '\n');
        }
        if (post.link) {
            yaml += '  link: ' + post.link + '\n';
            yaml += '  link_title: ' + post.link_title + '\n';
        }
        yaml += '\n';
    });

    // ä¸‹è½½æ–‡ä»¶
    const blob = new Blob([yaml], { type: 'text/yaml' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'thoughts.yml';
    a.click();

    console.log('æˆåŠŸæå– ' + posts.length + ' æ¡åŠ¨æ€');
    console.log(yaml);
    alert('æˆåŠŸæå– ' + posts.length + ' æ¡åŠ¨æ€ï¼\næ–‡ä»¶å·²ä¸‹è½½ä¸º thoughts.yml');
}
        </textarea>
        <button onclick="copyCode()" style="margin-top: 10px; padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">
            ğŸ“‹ å¤åˆ¶ä»£ç 
        </button>
    </div>

    <div class="warning">
        âš ï¸  æ³¨æ„ï¼šæ­¤å·¥å…·é€šè¿‡åˆ†æé¡µé¢ DOM ç»“æ„æå–æ•°æ®ï¼Œå¦‚æœå³åˆ»æ”¹ç‰ˆå¯èƒ½éœ€è¦æ›´æ–°ä»£ç 
    </div>

    <script>
        function copyCode() {
            const textarea = document.getElementById('consoleCode');
            textarea.select();
            document.execCommand('copy');
            alert('ä»£ç å·²å¤åˆ¶ï¼');
        }
    </script>
</body>
</html>
